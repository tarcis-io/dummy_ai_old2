FROM golang:1.23.4 AS build
WORKDIR /build

RUN useradd -u 10001 app-user

COPY go.mod go.sum .
RUN go mod download

COPY cmd/dummy_ai/main.go cmd/dummy_ai/
COPY internal/env/env.go internal/env/
COPY internal/server/server.go internal/server/
RUN CGO_ENABLED=0 go build -o app ./cmd/dummy_ai/

FROM scratch AS app
WORKDIR /app
